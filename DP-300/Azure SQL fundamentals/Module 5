Deploy highly available solutions by using Azure SQL

Backup and Restore

  Full database backup is taken once in a week
  Log backups are taken 5 - 10 minutes
  Differential backups every 12 hours
  The backup files are stored in Azure Storage in read-access geo-redundant storage (RA-GRS).

Create a backup strategy for Azure SQL managed instance and Azure SQL database

  PITR - Point in time restore
  Retention for PITR varies between 1 and 35 days. By default, the retention period (for all service tiers and deployment options) is 7 days

  LTR - Long term retention
  If 35 days isn't long enough to meet your organization's needs or compliance requirements, you can choose long-term retention (LTR). This option enables you to automatically create full database backups that are stored in RA-GRS storage for up to 10 years.

  Geo Restore
  If there's a catastrophic event, your organization needs to be able to recover. Your backups are automatically stored in RA-GRS storage. So if an entire region goes down and your databases or managed instances are in that region, you're protected. You can do a geo-restore to any other region from the most recent geo-replicated backup. This backup can be a bit behind the primary because it takes time to replicate the Azure blob to another region. You can easily perform a geo-restore by using the Azure portal, the PowerShell/Azure CLI, or REST APIs.

============================================================================================================================
Exercise - Restore to a point in time
============================================================================================================================

Hight Availability by Service Tier

  General Purpose - Application connects to a gateway which points connection request to the right server. VM uses temdb files stored on SSDs locally. Data and log files are stored in Azure Premium Storage (LRS) and Backup files are stored in (RA-GRS).

  Business Critical - Highest performance and availability among all service tiers. Business Critical is meant for mission-critical applications that need low latency and minimal downtime.
  AlwaysON Availability Groups (AG). An AG contains one primary replica and 3 secondary replica. A transaction can complete a commit if at least one secondary replica has hardened the changes for its transaction log
  Unlike in the General Purpose tier, in Business Critical, the data and log files are all running on direct-attached SSD, which significantly reduces network latency.

  Hyperscale

============================================================================================================================
Exercise - General Purpose High Availability
============================================================================================================================
============================================================================================================================
Exercise - Business Critical High Availability
============================================================================================================================

Going Further with Availability

  Availability Zones
    In the Business Critical tier in Azure SQL Database, you can opt in (for no additional fee) for a zone-redundant configuration if your region supports that. At a high level, the Always On availability group (AG) that runs behind Business Critical databases and managed instances is deployed across three Availability Zones within a region. An Availability Zone is basically a separate datacenter within a given region. There's always a physical separation between Availability Zones. This capability protects against catastrophic failures that might occur to a datacenter in a region.

  Azure SQL SLA
    you can achieve the highest availability (99.995%) from an Azure SQL Database Business Critical deployment that has Availability Zones configured. The Business Critical tier is the only option in the industry that provides RPO and RTO SLAs of 5 seconds and 30 seconds, respectively. RPO stands for recovery point object. It represents the amount of data you're potentially willing to lose in a worst case scenario. RTO stands for recovery time objective. It represents how long it takes to be back up and running again if a disaster occurs.
    For General Purpose or single-zone Business Critical deployments, the SLA is 99.99%.

  Geo Replication and Auto failover groups
    you can consider some other options for getting read-scale or the ability to fail over to another region: geo-replication and auto-failover groups.

Availability and Consistency

  Database Availability
    Accelerated Database Recovery (ADR) - ADR is on by default and can't be turned off.

  Database Consistency

Configure and Monitor Availability

  Monitor availability

  Region and Data center availability

  Instance, server, and database availability

  Backup and Restore History

  Replica Status : Replicas are used for Business critical service tiers. You can view the status of a replica by using the DMV sys.dm_database_replica_states.

  Failover Causes

  System Center Management Pack for Azure SQL
