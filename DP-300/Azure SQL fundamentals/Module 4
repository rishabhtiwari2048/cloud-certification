Deliver consistent performance with Azure SQL

Performance Capabilities

  Memory, CPU and I/O Capacities

    Azure SQL Database : 128 vCores, 4TB Memory, and 4 TB database Size
    Azure Hyperscale Deployment : 100 TB database size
    Azure Managed Instance : 80 vCores, 400 GB Memory, and 8 TB database size
    sys.dm_os_job_object can be used to find out resource limits

  Indexes

    Clustered and Non-Clustered indexes are supported
    Online and Resumable indexes are fully supported

  In-memory OLTP

  Partitions

  SQL Server 2019 performance enhancements

  Intelligent Performance

Configure and Maintain performance

  Tempdb :- Total number of database files for tempdb = 2*vCores (Max limit 16). it is 12 files independent of vCore on Managed instance

  Database Configuration :- you configure a database with the T-SQL ALTER DATABASE and ALTER DATABASE SCOPED CONFIGURATION statements. Many of the configuration options for performance are available for Azure SQL. Consult the ALTER DATABASE and ALTER DATABASE SCOPED CONFIGURATION T-SQL reference for the differences between SQL Server, Azure SQL Database, and Azure SQL Managed Instance.
  For performance, one option that you can't change is the recovery model of the database. The default is full recovery. This ensures your database can meet Azure service-level agreements (SLAs). Therefore, minimal logging for bulk operations isn't supported. Minimal logging for bulk operations is supported for tempdb.

  Files and File Group :- Azure SQL Database has one database file and its maximum size is configurable through Azure interface. Hyperscale has more than one database file. There is no functionality of creating additional database files. Azure SQL Managed Instance supports adding database files and configuring sizes but not physical placement of files. In addition, user-defined filegroups are supported for SQL Managed Instance for manageability purposes.

  MAXDOP Configuration :- Maximum degree of Parallalism is fully supported in Azure SQL Database

  Resource Governor :- Resource Governor is a feature in SQL Server that you can use to control resource usage for workloads through I/O, CPU, and memory. Note that for user-defined workload groups and pools, Resource Governor is supported for SQL Managed Instance, but not supported for Azure SQL Database.

  Index Maintenance :- Index creation and maintenance for Azure SQL is exactly the same as that for SQL Server.

  Statistics Maintenance :- SQL Server and Azure SQL handle statistics in the same way. Automatic statistics options for databases are available for both.

Monitor and Troubleshoot Performance

  Tools and capabilities to monitor performance

    Azure Monitor

    Dynamic Management Views

    Extended Events

    Light weight query profiling :- You use lightweight query profiling to examine the query plan and running state of an active query. This is a key feature to debug query performance for statements as they are running

    Query Plan Debug Capabilities :- In some situations, you might need additional details about query performance for an individual T-SQL statement. T-SQL SET statements, such as SHOWPLAN and STATISTICS, can provide these details and are fully supported for Azure SQL, as they are for SQL Server.

    Query Store :- Query Store is a historical record of performance execution for queries stored in the user database. Query Store is on by default for Azure SQL, and is used to provide capabilities such as automatic plan correction and automatic tuning.

    Performance Visualizations

    DMV Details:- Please visit unit 4 of this module

    Extended Event Details :- Please visit unit 4 of this module

Performance scenarios for Azure SQL :- Please visit unit 4 of this module

    Running

    Waiting

Scenarios specific to Azure SQL :- Please visit unit 4 of this module

    Log Governance

    Worker Limits

    Business Critical HADR waits

============================================================================================================================
Exercise - Monitor and troubleshoot performance
============================================================================================================================

Accelerate and Tune Performance

  Scale CPU Capacity

  I/O Performance (IOPS - Input Output Per Second)

  Increase Memory or Workers

  Improve Application Latency

  Tune Like it is a SQL Server

===========================================================================================================================
Exercise - Scale the performance of your workload
===========================================================================================================================

===========================================================================================================================
Exercise - Optimize application performance
===========================================================================================================================

Intelligent Performance

  Intelligent Query Processing - Intelligent query processing (IQP) is a suite of new capabilities built into the query processor. You enable it by using the latest database compatibility level. Applications can gain performance by simply using the latest database compatibility level.

  Automatic Plan Correction

  Automatic Tuning
