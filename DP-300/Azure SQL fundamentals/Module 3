Secure your data with Azure SQL

Security Capabilities and Tasks

Network Security

  a) Azure SQL Database
      There are four main ways of implementing network security in your Azure SQL Database
        1) Allow access to Azure Services - Allows Azure Services from any region and subscription to connect to your Azure SQL database
        2) Firewall Rules
        3) vNet Rules
        4) Azure Private Link

  b) An Azure SQL Managed Instance
       For an Azure SQL managed instance, either before or during deployment, you must create a specific subnet, or logical grouping within a virtual network, with several requirements to host the managed instances. After they're deployed, they're already configured similar to a private endpoint in a database in SQL Database. By using standard networking practices, you must enable access to the virtual network where the managed instance lives. By default, you have a private endpoint and relatively private DNS hierarchy.

Identity and Access

  Role Based Access Control (RBAC)
    Common roles given by Azure for management in Azure SQL database and Azure SQL Managed Instance
      1) SQL DB Contributor - Create and Manage Azure SQL Database but can't access database
      2) SQL Managed Instance Contributor - Create and Manage managed instance but can't access them
      3) SQL Security Manager - Can manage security policies for databases and instances (such as auditing) but can't access them
      4) SQL Server Contributor - Can manage servers and databases but can't access them.

  Authentication
    For both Azure SQL Database instances and Azure SQL managed instances, SQL authentication is used for deployment. This authentication role is referred to as the server admin.
    If you're migrating a workload that needs Windows Authentication or your organization uses Azure Active Directory (Azure AD), you can use Azure AD. For both Azure SQL managed instances and Azure SQL Database instances, you can assign an Azure AD server admin by using the portal or command-line tools.

    1) Azure Active Directory - Integrated: A non-interactive method that you can use if you're signed in to Windows with your Azure AD credentials from a federated domain
    2) Azure Active Directory - Password: A non-interactive method that allows you to connect with an Azure AD principal name by using the Azure AD-managed domain.
    3) Azure Active Directory - Universal with Multi-Factor Authentication: An interactive method that safeguards access to data while meeting an organization's demand for a single sign-in process with Azure AD Multi-Factor Authentication

    For Azure SQL Database instances, there are a few nuances. You can have SQL log-ins, database users, and even contained database users for Azure AD (recommended). Although the server admin for Azure SQL Database essentially has sysadmin rights, you can create more limited admins by using database level roles in the master of the Azure SQL Database logical server. Two roles are available:

    loginmanager: A database-level role that allows members to create logins for the database server.
    dbmanager: A database-level role that allows members to create and delete databases for the database server.


============================================================================================================================
Exercise - Configure auditing
============================================================================================================================

============================================================================================================================
Exercise - Secure Your Network
============================================================================================================================

============================================================================================================================
Exercise - Configure Authentication
============================================================================================================================

USE Statement is not supported in Azure SQL Database
You must connect to master database in order to create and alter logins

Protect Your Data

  Data Encryption
      TDE = Transparent Data Encryption (Responsible for data encryption at rest using 256 Bit Advanced Encryption Cipher)
      TLS = Transport Layer Security
      Customer Managed Key (BYOK - Bring your own key) and Service Managed Key options are available for encryption

  Dynamic Data Masking

Manage Your security

  Auditing - Auditing can help you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate potential security violations.
  Auditing is available at server level as well as at database level.
  You can use CREATE SERVER AUDIT with URL and EXTERNAL MONITOR option in order to store your audit files in a Blob Storage or Azure Monitor Logs (Log Analytics) or Event Hubs
  You can also enable Azure SQL audit and configure it to store the audit data in Blob Storage, Azure Monitor Logs or even Hubs
  You can utilize data stored in Blob Storage using XEvents files. You can query data from Monitoring logs using KQL.

  Monitoring

  Data Discovery and Classification

  Azure Defender

      a) Vulnerability Assessment - Scans databases in every 7 days and looks for the Vulnerabilities. Notifies owners and recommends corrective measures
      b) Advanced Threat Protection

============================================================================================================================
Exercise - Manage Security and Azure Defender
============================================================================================================================

============================================================================================================================
Exercise - Data classification, dynamic data masking, and SQL audit
============================================================================================================================
